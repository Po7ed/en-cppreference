<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>Search</title>
<style>
body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
label { margin-right: 8px; }
#results div { margin: 6px 0; }
</style>

<h1>Search</h1>

<input id="q" placeholder="keywords" style="width:100%;padding:8px;font-size:16px">

<div style="margin:10px 0">
  <label><input type="radio" name="lang" value="all" checked> all</label>
  <label><input type="radio" name="lang" value="en"> en</label>
  <label><input type="radio" name="lang" value="zh"> zh</label>
</div>

<div id="results"></div>

<script>
let idx = [];
let lang = "all";

fetch("./search.json").then(r => r.json()).then(d => idx = d);

document.querySelectorAll("input[name=lang]").forEach(r =>
  r.onchange = () => { lang = r.value; run(); }
);

document.getElementById("q").oninput = run;

function run() {
  const q = document.getElementById("q").value.trim().toLowerCase();
  const out = document.getElementById("results");

  if (!q) { out.innerHTML = ""; return; }

  let data = idx;

  if (lang !== "all") {
    const p = "/" + lang + "/";
    data = data.filter(x => x.url.startsWith(p));
  }

  const hits = data.filter(x => x.title.toLowerCase().includes(q));

  out.innerHTML = hits.map(x =>
    `<div><a href="${x.url}">${x.title}</a></div>`
  ).join("");
}
</script>
</html>

